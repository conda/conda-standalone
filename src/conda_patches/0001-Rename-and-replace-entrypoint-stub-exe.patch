From 936a565f39da5673eef8d7fff8394467ba9f47be Mon Sep 17 00:00:00 2001
From: Nehal J Wani <nehaljw.kkd1@gmail.com>
Date: Tue, 13 Aug 2019 07:43:35 -0400
Subject: [PATCH 1/4] Rename and replace entrypoint stub exe

---
 conda/core/path_actions.py | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/conda/core/path_actions.py b/conda/core/path_actions.py
index 9ed4daddc..3388e9c68 100644
--- a/conda/core/path_actions.py
+++ b/conda/core/path_actions.py
@@ -370,8 +370,12 @@ class LinkPathAction(CreateInPrefixPathAction):
         requested_link_type,
         entry_point_def,
     ):
-        source_directory = context.conda_prefix
-        source_short_path = "Scripts/conda.exe"
+        if lexists(join(sys.prefix, "entry_point_base.exe")):
+            source_directory = sys.prefix
+            source_short_path = "entry_point_base.exe"
+        else:
+            source_directory = context.conda_prefix
+            source_short_path = "Scripts/conda.exe"
         command, _, _ = parse_entry_point_def(entry_point_def)
         target_short_path = f"Scripts/{command}.exe"
         source_path_data = PathDataV1(
-- 
2.51.1.windows.1

